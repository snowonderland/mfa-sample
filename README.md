# Spring Security MFA 演示项目

基于 Spring Boot 4.0.1 + Spring Security 7.0 实现的多因素认证(MFA)示例项目。

## 🎯 项目特性

- **双重认证**: 用户名密码 + 一次性验证码(OTP)
- **Spring Security 7.0**: 使用官方MFA支持
- **邮箱验证**: 模拟邮件发送验证码
- **时序控制**: 验证码5分钟有效期
- **角色管理**: 支持管理员和普通用户角色
- **H2数据库**: 内置数据库，开箱即用

## 🚀 快速开始

### 环境要求

- JDK 17+
- Maven 3.6+

### 运行项目

1. 克隆项目到本地
2. 进入项目目录
3. 运行以下命令：

```bash
mvn spring-boot:run
```

4. 访问 http://localhost:8080

### 测试账号

| 用户名 | 密码 | 角色 | 说明 |
|--------|------|------|------|
| admin | admin123 | ADMIN | 管理员账号 |
| user | user123 | USER | 普通用户账号 |

## 📋 认证流程

1. **第一步**: 访问受保护页面，跳转到登录页面
2. **第二步**: 输入用户名和密码
3. **第三步**: 系统自动生成6位验证码并发送到邮箱（控制台输出）
4. **第四步**: 输入验证码完成MFA认证
5. **成功**: 访问目标页面



## 📱 演示效果

### 登录页面
- 用户名密码输入
- 友好的界面提示
- 测试账号显示

### OTP验证页面
- 验证码输入框
- 时效提醒
- 返回登录页面

### 首页
- 登录成功提示
- MFA功能介绍
- 管理员功能区域

## 🛠️ 技术栈

- **Spring Boot**: 4.0.1
- **Spring Security**: 7.0.2
- **Thymeleaf**: 模板引擎
- **H2 Database**: 内存数据库
- **JPA**: 数据访问层

## 🔒 安全特性

- BCrypt密码加密
- CSRF保护（开发环境已禁用）
- 验证码时效控制
- 一次性使用验证码
- 角色权限控制

## 📝 注意事项

1. 验证码会在控制台输出，实际项目中应集成邮件服务
2. 本项目使用H2内存数据库，重启后数据会丢失
3. 为了演示方便，所有用户都启用了MFA
4. 生产环境建议使用真实的邮件服务

## 🌟 扩展建议

- 集成Spring Mail发送真实邮件
- 支持短信验证码
- 添加验证码重新发送功能
- 支持多种MFA方式选择
- 添加登录日志记录
- 集成Redis存储OTP
